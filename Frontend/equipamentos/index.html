<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>GETI - Lista de Equipamentos</title>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>
  <div id="sidebar-container"></div>

  <div class="main-content">
    <h1>Lista de Equipamentos</h1>

    <table class="tabela-listagem" id="tabela-equipamentos">
      <thead>
        <tr>
          <th>Nome</th>
          <th>Nº de Série</th>
          <th>Tipo</th>
          <th>Status</th>
          <th>Data de Aquisição</th>
        </tr>
      </thead>
      <tbody>
        <!-- Linhas adicionadas dinamicamente -->
      </tbody>
    </table>
  </div>

  <script>
    // Carrega o sidebar dinamicamente
    fetch('/sidebar/index.html')
      .then(res => res.text())
      .then(html => {
        document.getElementById("sidebar-container").innerHTML = html;
        const script = document.createElement("script");
        script.src = "/sidebar/sidebar.js";
        document.body.appendChild(script);
      });

    // Busca e exibe os equipamentos
    fetch('https://sistema-de-gerenciamento-de-estoque-de-ti.onrender.com/equipamentos')
      .then(res => res.json())
      .then(data => {
        const corpoTabela = document.querySelector("#tabela-equipamentos tbody");
        corpoTabela.innerHTML = "";

        if (Array.isArray(data)) {
          data.forEach(eq => {
            const linha = document.createElement("tr");
            linha.innerHTML = `
              <td>${eq.nome}</td>
              <td>${eq.numero_serie}</td>
              <td>${eq.tipo || '---'}</td>
              <td>${eq.status}</td>
              <td>${eq.data_aquisicao || '---'}</td>
            `;
            corpoTabela.appendChild(linha);
          });
        } else {
          corpoTabela.innerHTML = `<tr><td colspan="5">Erro ao carregar dados.</td></tr>`;
        }
      })
      .catch(() => {
        const corpoTabela = document.querySelector("#tabela-equipamentos tbody");
        corpoTabela.innerHTML = `<tr><td colspan="5">Erro ao buscar equipamentos.</td></tr>`;
      });
  </script>
</body>
</html>
